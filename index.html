<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greenwin TravelPack Portal | IT Support & System Access</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Modern Color System */
            --primary: #004225;
            --secondary: #006837;
            --accent: #00a651;
            --surface: #FFFFFF;
            --surface-hover: #F7F9FC;
            --surface-active: #F0F4F9;
            
            /* Brand Colors */
            --brand-gradient: linear-gradient(135deg, #004225 0%, #006837 50%, #00a651 100%);
            --brand-gradient-soft: linear-gradient(135deg, rgba(0, 66, 37, 0.05) 0%, rgba(0, 104, 55, 0.05) 50%, rgba(0, 166, 81, 0.05) 100%);
            
            /* Semantic Colors */
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --info: #3B82F6;
            
            /* Text Colors */
            --text-primary: #111827;
            --text-secondary: #374151;
            --text-tertiary: #6B7280;
            --text-placeholder: #9CA3AF;
            
            /* Border Colors */
            --border-light: #E5E7EB;
            --border-medium: #D1D5DB;
            --border-focus: #00a651;
            
            /* Neutral Colors */
            --gray-50: #fafafa;
            --gray-100: #f5f5f5;
            --gray-200: #e5e5e5;
            --gray-300: #d4d4d4;
            --gray-400: #a3a3a3;
            --gray-500: #737373;
            --gray-600: #525252;
            --gray-700: #404040;
            --gray-800: #262626;
            --gray-900: #171717;
            
            /* Semantic Colors */
            --background: #ffffff;
            --surface: #fafafa;
            --surface-elevated: #ffffff;
            --border: #e5e5e5;
            --border-strong: #d4d4d4;
            --text-primary: #171717;
            --text-secondary: #525252;
            --text-muted: #737373;
            
            /* Modern Effects */
            --shadow-sm: 0 2px 4px rgba(0, 66, 37, 0.03);
            --shadow-md: 0 8px 24px rgba(0, 66, 37, 0.06);
            --shadow-lg: 0 24px 48px rgba(0, 66, 37, 0.08);
            --shadow-xl: 0 32px 64px rgba(0, 66, 37, 0.12);
            --glow-sm: 0 0 16px rgba(0, 166, 81, 0.2);
            --glow-md: 0 0 32px rgba(0, 166, 81, 0.3);
            
            /* Glass Effect */
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-shadow: 0 8px 32px rgba(0, 66, 37, 0.08);
            
            /* Animations */
            --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-smooth: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Spacing */
            --radius: 6px;
            --radius-lg: 8px;
            --radius-xl: 12px;
            
            /* Typography */
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
        }

        body {
            font-family: var(--font-sans);
            background: var(--surface);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(0, 166, 81, 0.03) 0%, transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(0, 104, 55, 0.03) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(0, 66, 37, 0.02) 0%, transparent 60%),
                linear-gradient(135deg, #FAFBFC 0%, #F0F4F8 100%);
            background-attachment: fixed;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--glass-border);
            padding: 24px 0;
            margin-bottom: 32px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--glass-shadow);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

                         .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--brand-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            letter-spacing: -0.5px;
            box-shadow: var(--glow-sm);
            position: relative;
            overflow: hidden;
            transition: var(--transition-smooth);
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
            transition: var(--transition-smooth);
        }

        .logo:hover .logo-icon::before {
            transform: translateX(100%);
        }

        .logo:hover .logo-icon {
            box-shadow: var(--glow-md);
            transform: scale(1.05);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .logo-brand {
            font-size: 22px;
            font-weight: 700;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
            line-height: 1;
        }

        .logo-subtitle {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1;
            margin-top: 4px;
            opacity: 0.8;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 24px;
            font-size: 14px;
            color: var(--text-muted);
        }

        .header-title {
            text-align: right;
        }

        .header-title h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
            line-height: 1.2;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        .header-title p {
            font-size: 14px;
            color: var(--text-secondary);
            margin: 4px 0 0 0;
        }





        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 32px;
        }

        .form-container {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 40px;
            box-shadow: var(--glass-shadow);
            transition: var(--transition-smooth);
        }

        .form-container:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .form-header {
            border-bottom: 1px solid var(--border);
            padding-bottom: 24px;
            margin-bottom: 32px;
        }

        .form-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .form-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 166, 81, 0.15);
            border-radius: var(--radius-xl);
            padding: 32px;
            box-shadow: 
                0 4px 12px rgba(0, 66, 37, 0.05),
                0 1px 3px rgba(0, 66, 37, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transition: var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, 
                rgba(0, 166, 81, 0.05) 0%,
                rgba(0, 104, 55, 0.08) 50%,
                rgba(0, 66, 37, 0.1) 100%
            );
            opacity: 0;
            transition: var(--transition-smooth);
            z-index: -1;
        }

        .info-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--brand-gradient);
            opacity: 0.8;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .info-card:hover {
            border-color: rgba(0, 166, 81, 0.3);
            box-shadow: 
                0 8px 24px rgba(0, 66, 37, 0.08),
                0 2px 4px rgba(0, 66, 37, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }

        .info-card:hover::before {
            opacity: 1;
        }

        .info-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

                 .info-card-icon {
             width: 20px;
             height: 20px;
             color: var(--greenwin-secondary);
         }

        .info-card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .info-card-content {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .info-list {
            list-style: none;
            margin: 16px 0 0 0;
            padding: 0;
        }

        .info-list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-200);
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }

        .info-list li:last-child {
            border-bottom: none;
        }

                 .info-list li::before {
             content: 'â€¢';
             color: var(--greenwin-accent);
             font-weight: bold;
             flex-shrink: 0;
             margin-top: 2px;
         }

        /* Form Sections */
        .form-section {
            margin-bottom: 32px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

                 .section-icon {
             width: 20px;
             height: 20px;
             color: var(--greenwin-secondary);
         }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--text-primary);
        }

        .required {
            color: var(--error);
        }

        /* Inputs */
        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid rgba(0, 166, 81, 0.15);
            border-radius: var(--radius-lg);
            font-size: 15px;
            font-family: inherit;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.8));
            color: var(--text-primary);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 2px 6px rgba(0, 66, 37, 0.05),
                0 1px 3px rgba(0, 66, 37, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-tertiary);
            opacity: 0.7;
        }

        .input-hint {
            font-size: 13px;
            color: var(--text-tertiary);
            margin-top: 8px;
            font-style: italic;
            padding-left: 4px;
            opacity: 0.8;
        }

        input:hover, select:hover, textarea:hover {
            border-color: rgba(0, 166, 81, 0.3);
            box-shadow: 
                0 4px 12px rgba(0, 66, 37, 0.08),
                0 2px 4px rgba(0, 66, 37, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-1px);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: rgba(0, 166, 81, 0.5);
            box-shadow: 
                0 0 0 3px rgba(0, 166, 81, 0.1),
                0 2px 6px rgba(0, 66, 37, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            transform: translateY(-1px);
        }

        input:focus::placeholder, 
        textarea:focus::placeholder {
            opacity: 0.5;
        }

        /* Custom select styling */
        select {
            background-image: linear-gradient(45deg, transparent 50%, rgba(0, 166, 81, 0.5) 50%),
                            linear-gradient(135deg, rgba(0, 166, 81, 0.5) 50%, transparent 50%);
            background-position: 
                calc(100% - 20px) calc(1em + 8px),
                calc(100% - 15px) calc(1em + 8px);
            background-size: 
                5px 5px,
                5px 5px;
            background-repeat: no-repeat;
            cursor: pointer;
        }

        select:hover {
            background-image: linear-gradient(45deg, transparent 50%, rgba(0, 166, 81, 0.8) 50%),
                            linear-gradient(135deg, rgba(0, 166, 81, 0.8) 50%, transparent 50%);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        select {
            cursor: pointer;
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23525252" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 12px;
            appearance: none;
        }

        /* Date Grid */
        .date-grid {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 20px;
            align-items: end;
        }

        .duration-display {
            padding: 12px 16px;
            background: var(--gray-100);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            font-size: 14px;
            white-space: nowrap;
            min-width: 100px;
        }

        /* Checkboxes */
                .checkbox-section {
            margin: 32px 0;
            padding: 32px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            border: 1px solid rgba(0, 166, 81, 0.15);
            border-radius: var(--radius-xl);
            box-shadow: 
                0 4px 16px rgba(0, 66, 37, 0.05),
                0 2px 4px rgba(0, 66, 37, 0.1);
        }

        .checkbox-section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(0, 166, 81, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .checkbox-section-title::before {
            content: '\f058';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--accent);
            font-size: 20px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            padding: 20px 24px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.8));
            border: 1px solid rgba(0, 166, 81, 0.15);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .checkbox-item::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg,
                rgba(0, 166, 81, 0.03) 0%,
                rgba(0, 104, 55, 0.05) 50%,
                rgba(0, 66, 37, 0.07) 100%
            );
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 0;
        }

        .checkbox-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--brand-gradient);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            border-color: rgba(0, 166, 81, 0.3);
            box-shadow: 
                0 6px 16px rgba(0, 66, 37, 0.08),
                0 2px 4px rgba(0, 66, 37, 0.12);
            transform: translateY(-1px);
        }

        .checkbox-item:hover::before {
            opacity: 1;
        }

        .checkbox-item:hover::after {
            opacity: 0.8;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            min-width: 20px;
            min-height: 20px;
            margin: 2px 0 0 0;
            cursor: pointer;
            position: relative;
            z-index: 1;
            border: 2px solid rgba(0, 166, 81, 0.3);
            border-radius: 4px;
            appearance: none;
            -webkit-appearance: none;
            background: white;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .checkbox-item input[type="checkbox"]:checked {
            background: var(--accent);
            border-color: var(--accent);
        }

        .checkbox-item input[type="checkbox"]:checked::before {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
        }

        .checkbox-item input[type="checkbox"]:hover {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 166, 81, 0.1);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-size: 15px;
            color: var(--text-primary);
            font-weight: 400;
            line-height: 1.5;
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .checkbox-item .required {
            color: var(--accent);
            margin-left: 4px;
        }

        /* Submit Section */
        .submit-section {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

                         .submit-btn {
            background: var(--brand-gradient);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: var(--radius-lg);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            min-height: 56px;
            box-shadow: 
                0 4px 12px rgba(0, 166, 81, 0.2),
                0 2px 4px rgba(0, 166, 81, 0.1),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                45deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent
            );
            transform: translateX(-100%);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .submit-btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                rgba(255, 255, 255, 0.2),
                transparent
            );
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .submit-btn:hover {
            box-shadow: 
                0 8px 24px rgba(0, 166, 81, 0.25),
                0 4px 8px rgba(0, 166, 81, 0.15),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .submit-btn:hover::before {
            transform: translateX(100%);
        }

        .submit-btn:hover::after {
            opacity: 1;
        }

        .submit-btn:active {
            transform: translateY(-1px);
            box-shadow: 
                0 6px 16px rgba(0, 166, 81, 0.2),
                0 3px 6px rgba(0, 166, 81, 0.1),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
        }

        .submit-btn:disabled {
            background: linear-gradient(135deg, #9CA3AF, #6B7280);
            cursor: not-allowed;
            box-shadow: none;
            border-color: rgba(255, 255, 255, 0.1);
            opacity: 0.7;
        }

        .submit-btn i {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .submit-btn:hover i {
            transform: translateX(4px);
        }

        .submit-note {
            font-size: 14px;
            color: var(--text-muted);
            text-align: center;
        }

        .loading {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            display: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Alerts */
        .alert {
            padding: 16px;
            border-radius: var(--radius);
            margin-bottom: 24px;
            border-left: 4px solid;
            font-size: 14px;
        }

        .alert-error {
            background: #fef2f2;
            border-color: var(--error);
            color: #991b1b;
        }

        .alert-warning {
            background: #fffbeb;
            border-color: var(--warning);
            color: #92400e;
        }

                 .alert-success {
             background: #f0fdf4;
             border-color: var(--greenwin-accent);
             color: var(--greenwin-primary);
         }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 8px;
            }
            .header-content {
                flex-direction: column;
                gap: 16px;
                text-align: center;
                justify-content: center !important;
                align-items: center !important;
                padding-left: 0 !important;
                padding-right: 0 !important;
            }
            .header-title, .logo-text {
                text-align: center !important;
                align-items: center !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
            }
            .form-container {
                padding: 12px;
            }
            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .date-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            .logo-text {
                align-items: center;
            }
            .form-group {
                margin-bottom: 28px;
            }
            input, select, textarea, button, .submit-btn {
                font-size: 18px;
                min-height: 48px;
                padding: 16px 14px;
            }
            .submit-btn {
                min-height: 56px;
                font-size: 20px;
            }
            .alert, .alert-success, .alert-error, .alert-warning {
                font-size: 16px;
                padding: 18px 10px;
                word-break: break-word;
            }
            .modal-overlay, .modal {
                max-width: 98vw !important;
                width: 98vw !important;
                left: 1vw !important;
                right: 1vw !important;
                box-sizing: border-box;
            }
            .modal {
                max-height: 90vh !important;
                overflow-y: auto !important;
                padding: 10px !important;
            }
        }

        /* Professional enhancements */
        .form-container {
            position: relative;
        }

                 .form-container::before {
             content: '';
             position: absolute;
             top: 0;
             left: 0;
             right: 0;
             height: 4px;
             background: linear-gradient(90deg, var(--greenwin-primary) 0%, var(--greenwin-secondary) 50%, var(--greenwin-accent) 100%);
             border-radius: var(--radius-xl) var(--radius-xl) 0 0;
         }

        .info-priority {
            background: linear-gradient(135deg, rgba(0, 66, 37, 0.03) 0%, rgba(0, 104, 55, 0.05) 100%);
            border: 1px solid rgba(0, 166, 81, 0.2);
            border-radius: var(--radius-lg);
            padding: 24px 28px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: var(--transition-smooth);
        }

        .info-priority:hover {
            box-shadow: var(--shadow-md);
            border-color: rgba(0, 166, 81, 0.3);
            transform: translateY(-1px);
        }

        .info-priority::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--brand-gradient);
            border-radius: 4px 0 0 4px;
        }

        .info-priority-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            position: relative;
        }

        .info-priority-header i {
            font-size: 20px;
            color: var(--accent);
            background: rgba(0, 166, 81, 0.1);
            padding: 12px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
        }

        .info-priority-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-priority-content {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-top: 8px;
            padding-left: 44px;
        }

        .info-priority strong {
            color: var(--primary);
            font-weight: 600;
            background: linear-gradient(120deg, rgba(0, 166, 81, 0.1) 0%, rgba(0, 166, 81, 0.1) 100%);
            padding: 2px 8px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">GW</div>
                <div class="logo-text">
                    <div class="logo-brand">Greenwin Corp</div>
                    <div class="logo-subtitle">Travel Approval Portal</div>
                </div>
            </div>
            <div class="header-meta">
                <div class="header-title">
                    <h1>Travel Approval</h1>
                    <p>International Travel & System Access Request</p>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <div class="form-container">
                <div class="form-header">
                    <h1 class="form-title">International Travel Notification</h1>
                    <p class="form-subtitle">Submit device and system access requirements for international travel</p>
                </div>

                <div class="info-priority">
                    <div class="info-priority-header">
                        <i class="fas fa-clock"></i>
                        <div class="info-priority-title">Processing Timeline</div>
                    </div>
                    <div class="info-priority-content">
                        Submit this form at least <strong>4 business days before departure</strong> to ensure IT Support can configure conditional access policies for your destination. For weekend or Monday departures, additional lead time may be required. This timeline is necessary to properly set up and test all necessary system access for your travel location, accounting for potential system changes and security validations.
                    </div>
                </div>

                <form id="travelForm" action="mailto:ITSupport@greenwin.ca" method="POST" enctype="text/plain">
                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-user section-icon"></i>
                            <h2 class="section-title">Employee Information</h2>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="fullName">Full Name <span class="required">*</span></label>
                                <input type="text" id="fullName" name="fullName" required placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address <span class="required">*</span></label>
                                <input type="email" id="email" name="email" required placeholder="your.email@greenwin.ca">
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="phone">Phone Number <span class="required">*</span></label>
                                <input type="tel" id="phone" name="phone" required placeholder="+1 (555) 123-4567">
                            </div>
                            <div class="form-group">
                            <label for="manager">Manager/Supervisor Email <span class="required">*</span></label>
                            <input type="email" id="manager" name="manager" required placeholder="manager.name@greenwin.ca">
                            <div class="input-hint">Enter the full email address of your manager/supervisor</div>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="department">Department</label>
                                <input type="text" id="department" name="department" placeholder="Your department">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-header">
                            <i class="fas fa-globe section-icon"></i>
                            <h2 class="section-title">Travel Details</h2>
                        </div>
                        <div class="date-grid">
                            <div class="form-group">
                                <label for="startDate">Departure Date <span class="required">*</span></label>
                                <input type="date" id="startDate" name="startDate" required>
                            </div>
                            <div class="form-group">
                                <label for="endDate">Return Date <span class="required">*</span></label>
                                <input type="date" id="endDate" name="endDate" required>
                            </div>
                            <div class="form-group">
                                <label for="duration">Duration</label>
                                <div class="duration-display" id="duration">-</div>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="destination">Destination Country <span class="required">*</span></label>
                                <select id="destination" name="destination" required>
                                    <option value="">Select destination country</option>
                                    <option value="United States">United States</option>
                                    <option value="United Kingdom">United Kingdom</option>
                                    <option value="France">France</option>
                                    <option value="Germany">Germany</option>
                                    <option value="Japan">Japan</option>
                                    <option value="Australia">Australia</option>
                                    <option value="China">China</option>
                                    <option value="India">India</option>
                                    <option value="Brazil">Brazil</option>
                                    <option value="Mexico">Mexico</option>
                                    <option value="Italy">Italy</option>
                                    <option value="Spain">Spain</option>
                                    <option value="Netherlands">Netherlands</option>
                                    <option value="Switzerland">Switzerland</option>
                                    <option value="Sweden">Sweden</option>
                                    <option value="Norway">Norway</option>
                                    <option value="Denmark">Denmark</option>
                                    <option value="Finland">Finland</option>
                                    <option value="Belgium">Belgium</option>
                                    <option value="Austria">Austria</option>
                                    <option value="Ireland">Ireland</option>
                                    <option value="Portugal">Portugal</option>
                                    <option value="Greece">Greece</option>
                                    <option value="Poland">Poland</option>
                                    <option value="South Korea">South Korea</option>
                                    <option value="Singapore">Singapore</option>
                                    <option value="New Zealand">New Zealand</option>
                                    <option value="South Africa">South Africa</option>
                                    <option value="Argentina">Argentina</option>
                                    <option value="Chile">Chile</option>
                                    <option value="Thailand">Thailand</option>
                                    <option value="Indonesia">Indonesia</option>
                                    <option value="Other">Other (specify in purpose)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label for="purpose">Purpose & System Requirements</label>
                            <textarea id="purpose" name="purpose" placeholder="Describe the purpose of your travel and specify which company systems you'll need access to (email, SharePoint, Teams, CRM, etc.)"></textarea>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="devices">Company Devices <span class="required">*</span></label>
                                                         <textarea id="devices" name="devices" required placeholder="List all company devices you'll be traveling with (laptop model, phone model, tablet, etc.)"></textarea>
                        </div>
                    </div>

                    <div class="checkbox-section">
                        <div class="checkbox-section-title">Acknowledgments & Compliance</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="systemAccess" name="systemAccess" required>
                                <label for="systemAccess">I understand that IT Support will configure Microsoft Exchange conditional access policies for my travel destination to maintain access to company systems. <span class="required">*</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="deviceCompliance" name="deviceCompliance" required>
                                <label for="deviceCompliance">I confirm all company devices are up-to-date with security patches and will comply with any additional security policies applied during travel. <span class="required">*</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="authRequirement" name="authRequirement" required>
                                <label for="authRequirement">I understand that secure authentication protocols and MFA are required for all company system access while traveling abroad. <span class="required">*</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="itSupport" name="itSupport" required>
                                <label for="itSupport">I will contact ITSupport@greenwin.ca for any technical issues and understand that system access may be temporarily restricted for security purposes. <span class="required">*</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dataCompliance" name="dataCompliance" required>
                                <label for="dataCompliance">I agree that this information will be used by IT Support to configure secure access policies and understand all system activity will be monitored during travel. <span class="required">*</span></label>
                            </div>
                        </div>
                    </div>

                    <div class="submit-section">
                        <button type="submit" class="submit-btn">
                            <span class="loading"></span>
                            <i class="fas fa-paper-plane"></i>
                            <span>Submit for Approval</span>
                        </button>
                    </div>
                </form>
            </div>

            <div class="sidebar">
                <div class="info-card">
                    <div class="info-card-header">
                        <i class="fas fa-server info-card-icon"></i>
                        <div class="info-card-title">System Access Configuration</div>
                    </div>
                    <div class="info-card-content">
                        IT Support will configure the following for your travel:
                        <ul class="info-list">
                            <li>Microsoft Exchange conditional access policies</li>
                            <li>SharePoint and Teams international access</li>
                            <li>OneDrive sync authentication protocols</li>
                            <li>Office 365 application compliance settings</li>
                            <li>Multi-factor authentication requirements</li>
                            <li>System access monitoring and logging</li>
                        </ul>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <i class="fas fa-mobile-alt info-card-icon"></i>
                        <div class="info-card-title">Device Requirements</div>
                    </div>
                    <div class="info-card-content">
                        Ensure your devices meet these requirements:
                        <ul class="info-list">
                            <li>International roaming enabled on company phones</li>
                            <li>Microsoft Authenticator app installed</li>
                            <li>Company system connectivity tested</li>
                            <li>Wi-Fi certificates updated for international use</li>
                            <li>Outlook and Teams mobile apps configured</li>
                        </ul>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <i class="fas fa-headset info-card-icon"></i>
                        <div class="info-card-title">IT Support Contact</div>
                    </div>
                    <div class="info-card-content">
                        <strong>Email:</strong> ITSupport@greenwin.ca<br>
                        <strong>Response Time:</strong> 24-48 hours for travel requests<br>
                        <strong>Emergency Support:</strong> Available for critical issues during travel
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Calculate duration automatically
            function calculateDuration() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                const durationDisplay = document.getElementById('duration');
                
                if (startDate && endDate) {
                    const start = new Date(startDate);
                    const end = new Date(endDate);
                    const diffTime = end - start;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                    
                                         if (diffDays > 0) {
                         durationDisplay.textContent = `${diffDays} day${diffDays > 1 ? 's' : ''}`;
                         durationDisplay.style.color = 'var(--greenwin-primary)';
                     } else {
                         durationDisplay.textContent = 'Invalid dates';
                         durationDisplay.style.color = 'var(--error)';
                     }
                 } else {
                     durationDisplay.textContent = '-';
                     durationDisplay.style.color = 'var(--text-muted)';
                 }
            }

            // Add event listeners for date changes
            document.getElementById('startDate').addEventListener('change', calculateDuration);
            document.getElementById('endDate').addEventListener('change', calculateDuration);

            // Form validation and submission
            document.getElementById('travelForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const submitBtn = document.querySelector('.submit-btn');
                const loading = submitBtn.querySelector('.loading');
                const btnText = submitBtn.querySelector('span:last-child');
                
                // Show loading state
                submitBtn.disabled = true;
                loading.style.display = 'inline-block';
                btnText.textContent = 'Processing...';
                
                // Validate all required fields
                const requiredFields = ['fullName', 'email', 'phone', 'manager', 'startDate', 'endDate', 'destination', 'devices'];
                const requiredCheckboxes = ['systemAccess', 'deviceCompliance', 'authRequirement', 'itSupport', 'dataCompliance'];
                
                let isValid = true;
                let errorMessage = '';
                
                // Check required fields
                requiredFields.forEach(field => {
                    const element = document.getElementById(field);
                    if (!element.value.trim()) {
                        element.style.borderColor = 'var(--error)';
                        element.style.boxShadow = '0 0 0 3px rgba(220, 53, 69, 0.1)';
                        isValid = false;
                    } else {
                        element.style.borderColor = 'var(--border)';
                        element.style.boxShadow = 'none';
                    }
                });
                
                // Check required checkboxes
                requiredCheckboxes.forEach(checkbox => {
                    const element = document.getElementById(checkbox);
                    const container = element.closest('.checkbox-item');
                    if (!element.checked) {
                        container.style.borderColor = 'var(--error)';
                        container.style.boxShadow = '0 0 0 3px rgba(220, 53, 69, 0.1)';
                        isValid = false;
                    } else {
                        container.style.borderColor = 'var(--border)';
                        container.style.boxShadow = 'none';
                    }
                });
                
                // Validate email format
                const email = document.getElementById('email').value;
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (email && !emailRegex.test(email)) {
                    document.getElementById('email').style.borderColor = 'var(--error)';
                    isValid = false;
                    errorMessage = 'Please enter a valid email address.';
                }
                
                // Validate date range
                const startDate = new Date(document.getElementById('startDate').value);
                const endDate = new Date(document.getElementById('endDate').value);
                
                if (startDate && endDate && endDate <= startDate) {
                    document.getElementById('endDate').style.borderColor = 'var(--error)';
                    isValid = false;
                    errorMessage = 'Return date must be after departure date.';
                }
                
                console.log('Processing form submission...');
                
                // Process form submission
                setTimeout(() => {
                    try {
                        console.log('Form validation result:', isValid);
                        
                        if (isValid) {
                        // Create simplified email body for better Windows compatibility
                        const formData = new FormData(this);
                        const duration = document.getElementById('duration').textContent;
                        
                        // Create a shorter, simpler email body
                        const emailBody = `Dear ${formData.get('manager')},

Please review and approve this travel request, then forward to ITSupport@greenwin.ca:

TRAVEL REQUEST - ${formData.get('fullName')}
Employee: ${formData.get('fullName')} (${formData.get('email')})
Phone: ${formData.get('phone')}
Department: ${formData.get('department') || 'Not specified'}

Travel Dates: ${formData.get('startDate')} to ${formData.get('endDate')} (${duration})
Destination: ${formData.get('destination')}

Purpose: ${formData.get('purpose') || 'Not specified'}

Company Devices: ${formData.get('devices')}

IMPORTANT: This requires 4 business days processing time.
After approval, forward to ITSupport@greenwin.ca for system configuration.

Generated by Greenwin TravelPack Portal - ${new Date().toLocaleDateString()}`;

                        // Create detailed content for clipboard/fallback
                        const detailedContent = `To: ${formData.get('manager')}
Subject: [APPROVAL NEEDED] Travel Request - ${formData.get('fullName')} - ${formData.get('destination')}

Dear ${formData.get('manager')},

Please review and approve the following travel request. Once approved, kindly forward this email to ITSupport@greenwin.ca for system access configuration.

GREENWIN TRAVELPACK REQUEST
------------------------------------------

Employee Details:
â€¢ Full Name: ${formData.get('fullName')}
â€¢ Email: ${formData.get('email')}
â€¢ Phone: ${formData.get('phone')}
â€¢ Department: ${formData.get('department') || 'Not specified'}

Travel Information:
â€¢ Departure Date: ${formData.get('startDate')}
â€¢ Return Date: ${formData.get('endDate')}
â€¢ Duration: ${duration}
â€¢ Destination: ${formData.get('destination')}

Purpose:
${formData.get('purpose') || 'Not specified'}

Company Devices:
${formData.get('devices')}

REQUIRED IT ACTIONS AFTER APPROVAL:
1. Configure Microsoft Exchange access for ${formData.get('destination')}
2. Enable international Office 365 access
3. Apply travel security policies
4. Configure authentication protocols
5. Setup system monitoring

IMPORTANT TIMELINE REQUIREMENTS:
â€¢ This request requires minimum 4 business days advance processing
â€¢ For weekend or Monday departures, submit earlier if possible
â€¢ Please forward to ITSupport@greenwin.ca after approval
â€¢ IT configuration and testing cannot begin without manager approval
â€¢ Late submissions may result in delayed system access

Generated by: Greenwin TravelPack Portal
Request Date: ${new Date().toLocaleDateString()}`;

                        // Get manager's email from the form
                        const managerEmail = document.getElementById('manager').value;
                        
                        // Create simplified mailto link
                        const ccList = 'AKeresztes@greenwin.ca,MAnnable@greenwin.ca,NKhan@greenwin.ca';
                        const subject = `Travel Request - ${formData.get('fullName')} - ${formData.get('destination')}`;
                        const simpleMailtoLink = `mailto:${managerEmail}?cc=${encodeURIComponent(ccList)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
                        
                        console.log('Attempting to open email client...');
                        console.log('Manager email:', managerEmail);
                        console.log('Subject length:', subject.length);
                        console.log('Body length:', emailBody.length);
                        
                        // Copy detailed content to clipboard first
                        const copyToClipboard = () => {
                            const textarea = document.createElement('textarea');
                            textarea.value = detailedContent;
                            textarea.style.position = 'fixed';
                            textarea.style.opacity = '0';
                            document.body.appendChild(textarea);
                            textarea.select();
                            
                            try {
                                if (navigator.clipboard && window.isSecureContext) {
                                    navigator.clipboard.writeText(detailedContent)
                                        .then(() => console.log('Detailed content copied to clipboard'))
                                        .catch(() => document.execCommand('copy'));
                                } else {
                                    document.execCommand('copy');
                                    console.log('Content copied using execCommand');
                                }
                            } catch (err) {
                                console.log('Clipboard copy failed:', err);
                            }
                            
                            document.body.removeChild(textarea);
                        };
                        
                        // Copy content immediately
                        copyToClipboard();
                        
                        // Try to open email client with simplified approach
                        let emailOpened = false;
                        
                        try {
                            // Direct window.location approach (most reliable for Windows)
                            window.location.href = simpleMailtoLink;
                            emailOpened = true;
                            console.log('Email client opened via window.location');
                        } catch (error) {
                            console.log('window.location failed:', error);
                            
                            try {
                                // Fallback to window.open
                                window.open(simpleMailtoLink);
                                emailOpened = true;
                                console.log('Email client opened via window.open');
                            } catch (error2) {
                                console.log('window.open also failed:', error2);
                            }
                        }
                        
                        // Always show the modal after a short delay
                        setTimeout(() => {
                            const modal = document.createElement('div');
                            modal.style.cssText = `
                                position: fixed;
                                top: 50%;
                                left: 50%;
                                transform: translate(-50%, -50%);
                                background: white;
                                padding: 32px;
                                border-radius: 12px;
                                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                                z-index: 1000;
                                max-width: 600px;
                                width: 90%;
                                max-height: 80vh;
                                overflow-y: auto;
                            `;
                            
                            modal.innerHTML = `
                                <div style="text-align: center; margin-bottom: 24px;">
                                    <i class="fas fa-envelope" style="font-size: 48px; color: var(--accent); margin-bottom: 16px;"></i>
                                    <h2 style="margin: 0; color: var(--text-primary);">Email Your Manager</h2>
                                </div>
                                
                                <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                                    <p style="margin: 0; color: var(--text-secondary); font-size: 14px;">
                                        <strong>Next Steps:</strong><br>
                                        1. ${emailOpened ? 'Your email client should have opened' : 'Open your email client manually'}<br>
                                        2. The complete email content is copied to your clipboard<br>
                                        3. Paste the content into a new email to: <strong>${managerEmail}</strong><br>
                                        4. Send the email for manager approval
                                    </p>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px;">
                                    <button onclick="window.open('https://outlook.office.com/compose', '_blank')" 
                                            style="padding: 12px 20px; background: #0078d4; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
                                        <i class="fas fa-external-link-alt"></i> Open Outlook Web
                                    </button>
                                    <button onclick="copyEmailContent()" 
                                            style="padding: 12px 20px; background: var(--accent); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
                                        <i class="fas fa-copy"></i> Copy Content Again
                                    </button>
                                </div>
                                
                                <div style="border: 1px solid #ddd; border-radius: 6px; padding: 16px; background: #fff; max-height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px; margin-bottom: 16px;">
                                    ${detailedContent.replace(/\n/g, '<br>').replace(/ /g, '&nbsp;')}
                                </div>
                                
                                <button onclick="this.closest('div').remove(); document.querySelector('.modal-overlay').remove()" 
                                        style="padding: 12px 24px; background: var(--success); color: white; border: none; border-radius: 6px; cursor: pointer; width: 100%; font-size: 16px;">
                                    <i class="fas fa-check"></i> Done - Email Sent
                                </button>
                            `;
                            
                            // Create overlay
                            const overlay = document.createElement('div');
                            overlay.className = 'modal-overlay';
                            overlay.style.cssText = `
                                position: fixed;
                                top: 0;
                                left: 0;
                                right: 0;
                                bottom: 0;
                                background: rgba(0, 0, 0, 0.6);
                                z-index: 999;
                            `;
                                                         
                             document.body.appendChild(overlay);
                             document.body.appendChild(modal);
                             
                             // Make copy function available globally
                             window.copyEmailContent = () => {
                                 if (navigator.clipboard && window.isSecureContext) {
                                     navigator.clipboard.writeText(detailedContent)
                                         .then(() => {
                                             console.log('Content copied to clipboard');
                                             // Show brief feedback
                                             const btn = document.querySelector('button[onclick="copyEmailContent()"]');
                                             if (btn) {
                                                 const originalText = btn.innerHTML;
                                                 btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                                                 btn.style.background = 'var(--success)';
                                                 setTimeout(() => {
                                                     btn.innerHTML = originalText;
                                                     btn.style.background = 'var(--accent)';
                                                 }, 2000);
                                             }
                                         })
                                         .catch(err => console.log('Copy failed:', err));
                                 } else {
                                     // Fallback for older browsers
                                     const textarea = document.createElement('textarea');
                                     textarea.value = detailedContent;
                                     textarea.style.position = 'fixed';
                                     textarea.style.opacity = '0';
                                     document.body.appendChild(textarea);
                                     textarea.select();
                                     try {
                                         document.execCommand('copy');
                                         console.log('Content copied using fallback method');
                                     } catch (err) {
                                         console.log('Copy failed:', err);
                                     }
                                     document.body.removeChild(textarea);
                                 }
                             };
                             
                         }, 500);
                        
                        // Show success message
                        const successAlert = document.createElement('div');
                        successAlert.className = 'alert alert-success';
                        successAlert.innerHTML = `
                            <i class="fas fa-check-circle"></i>
                            <strong>Travel Request Processed!</strong><br>
                            â€¢ A detailed email has been prepared for your manager<br>
                            â€¢ Content has been copied to your clipboard<br>
                            â€¢ Follow the instructions in the popup to complete your submission<br>
                            â€¢ Your manager will review and forward to IT Support after approval
                        `;
                        
                        document.querySelector('.form-container').insertBefore(
                            successAlert, 
                            document.querySelector('.form-section')
                        );
                        
                        // Scroll to success message
                        successAlert.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        
                    } else {
                        // Show error message
                        const errorAlert = document.createElement('div');
                        errorAlert.className = 'alert alert-error';
                        errorAlert.innerHTML = `
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>Validation Error</strong> ${errorMessage || 'Please fill in all required fields and complete all acknowledgments.'}
                        `;
                        
                        // Remove existing alerts
                        const existingAlert = document.querySelector('.alert');
                        if (existingAlert) {
                            existingAlert.remove();
                        }
                        
                        document.querySelector('.form-container').insertBefore(
                            errorAlert, 
                            document.querySelector('.form-section')
                        );
                        
                        // Scroll to error message
                        errorAlert.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    
                    } catch (error) {
                        console.error('Error during form submission:', error);
                        
                        // Show error message
                        const errorAlert = document.createElement('div');
                        errorAlert.className = 'alert alert-error';
                        errorAlert.innerHTML = `
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>Submission Error</strong> There was an error processing your request. Please try again or contact IT Support.
                        `;
                        
                        // Remove existing alerts
                        const existingAlert = document.querySelector('.alert');
                        if (existingAlert) {
                            existingAlert.remove();
                        }
                        
                        document.querySelector('.form-container').insertBefore(
                            errorAlert, 
                            document.querySelector('.form-section')
                        );
                        
                        errorAlert.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    
                    // Reset button state (always execute)
                    submitBtn.disabled = false;
                    loading.style.display = 'none';
                    btnText.textContent = 'Submit for Approval';
                    
                }, 800);
            });

            // Set minimum date to 4 business days from today
            function addBusinessDays(date, days) {
                let result = new Date(date);
                let addedDays = 0;
                while (addedDays < days) {
                    result.setDate(result.getDate() + 1);
                    if (result.getDay() !== 0 && result.getDay() !== 6) {
                        addedDays++;
                    }
                }
                return result;
            }

            const today = new Date();
            const minDepartureDate = addBusinessDays(today, 4);
            
            // Format dates for input fields
            const formatDate = (date) => date.toISOString().split('T')[0];
            
            // Set minimum dates
            document.getElementById('startDate').setAttribute('min', formatDate(minDepartureDate));
            document.getElementById('endDate').setAttribute('min', formatDate(today));
            
            // Add warning for weekend departures
            document.getElementById('startDate').addEventListener('change', function() {
                const selectedDate = new Date(this.value);
                const dayOfWeek = selectedDate.getDay();
                const warningDiv = document.getElementById('dateWarning') || document.createElement('div');
                warningDiv.id = 'dateWarning';
                
                if (dayOfWeek === 0 || dayOfWeek === 1) { // Sunday or Monday
                    warningDiv.className = 'alert alert-warning';
                    warningDiv.innerHTML = `
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Important Notice:</strong> You've selected a ${dayOfWeek === 0 ? 'Sunday' : 'Monday'} departure. 
                        Please ensure submission well in advance as IT Support processing occurs during business days only.
                    `;
                    if (!document.getElementById('dateWarning')) {
                        document.querySelector('.date-grid').insertAdjacentElement('afterend', warningDiv);
                    }
                } else {
                    if (document.getElementById('dateWarning')) {
                        document.getElementById('dateWarning').remove();
                    }
                }
            });
        });
    </script>
</body>
</html> 